{"version":3,"file":"commonHelpers.js","sources":["../js/pixabay-api.js","../js/render-functions.js","../src/img/caution.svg","../src/img/error.svg","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst KEY = '42472601-e2efb745d6431960b7108569a';\nconst PER_PAGE = 15;\n\nexport async function fetchImages(search, page = 1) {\n    const url = `https://pixabay.com/api/?key=${KEY}&q=${search}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${PER_PAGE}`;\n\n    try {\n        const response = await axios.get(url);\n\n        if (response.status !== 200) {\n            throw new Error(`HTTP error! Status: ${response.status}`);\n        }\n        \n        return response.data;\n    } catch (error) {\n        throw new Error(`Error fetching images: ${error.message}`);\n    }\n}\n\n","//бібліотеки\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst LOADER = document.getElementById('loader');\nconst GALLERY = document.getElementById('gallery');\nconst lightbox = new SimpleLightbox('.gallery a');\n\nexport async function showImages(images) {\n    const markup = images.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) =>\n        `<div class=\"card\">\n      <a href=\"${largeImageURL}\" data-lightbox=\"gallery\" data-title=\"${tags}\">\n        <img src=\"${webformatURL}\" alt=\"${tags}\" title=\"${tags}\"/>\n      </a>\n      <div class=\"card-border\">\n      <div class=\"param\">\n      <p class=\"title\">Likes:</p>\n      <p class=\"title\">Views:</p>\n      <p class=\"title\">Comments:</p>\n      <p class=\"title\">Downloads:</p>\n       </div>\n        <div class=\"param\">\n      <p class=\"title-value\">${likes}</p>\n      <p class=\"title-value\">${views}</p>\n      <p class=\"title-value\">${comments}</p>\n      <p class=\"title-value\">${downloads}</p>\n       </div>\n      </div>\n    </div>`);\n\n    GALLERY.innerHTML = markup.join('');\n\n    const imgLoad = GALLERY.querySelectorAll('img');\n    const loadDelay = Array.from(imgLoad).map(img =>\n        new Promise((resolve, reject) => {\n            img.onload = resolve;\n            img.onerror = reject;\n        })\n    );\n\n    try {\n        await Promise.all(loadDelay);\n        LOADER.style.display = 'none';\n        lightbox.refresh()\n    } catch (error) {\n            console.error('Error loading images:', error);\n        }\n    }\n    \n        \n           ","export default \"__VITE_ASSET__02852ca5__\"","export default \"__VITE_ASSET__8479b7dd__\"","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from \"axios\";\nimport { fetchImages } from \"../js/pixabay-api\";\nimport { showImages } from \"../js/render-functions\";\n\nimport cautionIcon from './img/caution.svg';\nimport errorIcon from './img/error.svg';\n\n// Отримання елементів DOM\nconst LOADER = document.getElementById('loader');\nconst GALLERY = document.getElementById('gallery');\nconst SEARCH_FORM = document.getElementById('search-form');\nconst SEARCH_INPUT = document.getElementById('search-input');\nconst LOAD_MORE_BUTTON = document.getElementById('load-more-btn');\n\n// Ініціалізація галереї lightbox\nconst lightbox = new SimpleLightbox('.gallery a');\n\n// Параметри для пагінації\nlet currentPage = 1;\nlet currentQuery = \"\";\nlet PER_PAGE = 15;\n// Глобальна змінна для зберігання всіх зображень\nlet allImages = [];\n\n// Функція для відображення/приховування кнопки \"Load more\"\nfunction toggleLoadMoreButton(show) {\n    LOAD_MORE_BUTTON.style.display = show ? 'block' : 'none';\n}\n\n// Функція для відображення/приховування індикатора завантаження\nfunction updateLoaderVisibility(show) {\n    LOADER.style.display = show ? 'block' : 'none';\n}\n\n// Функція завантаження додаткових зображень\nasync function loadMoreImages() {\n    updateLoaderVisibility(true);\n\n    try {\n        currentPage += 1;\n        const data = await fetchImages(currentQuery, currentPage, PER_PAGE);\n        const totalHits = data.totalHits;\n        const totalPages = Math.floor(totalHits / PER_PAGE);\n\n        if (currentPage > totalPages) {\n            iziToast.error({\n                message: \"We're sorry, but you've reached the end of search results.\",\n                theme: 'dark',\n                position: 'topRight',\n                backgroundColor: '#ef4040',\n                messageColor: '#fafafb',\n                iconUrl: errorIcon,\n            });\n            toggleLoadMoreButton(false);\n        } else {\n            // Додаємо нові зображення до існуючих\n            allImages = [...allImages, ...data.hits];\n            showImages(allImages);\n            const cardHeight = GALLERY.querySelector('.card').getBoundingClientRect().height;\n            window.scrollBy({\n                top: cardHeight * 2,\n                behavior: \"smooth\",\n            });\n        }\n    } catch (error) {\n        iziToast.error({\n            title: 'Error',\n            message: 'An error occurred while fetching more images. Please try again.'\n        });\n        console.error('Error fetching more images:', error);\n    } finally {\n       updateLoaderVisibility(false);\n    }\n}\n\n\n\n// Функція для виконання пошуку\nasync function performSearch(query) {\n    updateLoaderVisibility(true);\n\n    try {\n        const data = await fetchImages(query);\n\n        if (data.hits.length === 0) {\n            iziToast.warning({\n                title: 'No results',\n                message: 'Sorry, there are no images matching your search. Please try again!',\n                theme: 'dark',\n                position: 'topRight',\n                backgroundColor: '#ffa000',\n                messageColor: '#fafafb',\n                iconUrl: cautionIcon\n            });\n        } else {\n            showImages(data.hits);\n            toggleLoadMoreButton(true);\n        }\n    } catch (error) {\n        iziToast.error({\n            title: 'Error',\n            message: 'An error occurred while fetching images. Please try again!'\n        });\n        console.error('Error fetching images:', error);\n    } finally {\n        updateLoaderVisibility(false);\n    }\n}\n\n// Функція обробки події відправлення форми пошуку\nasync function searchFormSubmit(event) {\n    event.preventDefault();\n    currentPage = 1;\n    const query = SEARCH_INPUT.value.trim();\n    currentQuery = query;\n\n    if (query === \"\") {\n        iziToast.error({\n            title: 'Error',\n            message: 'Please enter a search term!',\n            theme: 'dark',\n            position: 'topRight',\n            backgroundColor: '#ef4040',\n            messageColor: '#fafafb',\n            iconUrl: errorIcon,\n        });\n        return;\n    }\n\n    GALLERY.innerHTML = \"\";\n    toggleLoadMoreButton(false);\n\n    await performSearch(query);\n}\n\n// Додавання слухача події для форми пошуку\nSEARCH_FORM.addEventListener('submit', searchFormSubmit);\n\n// Додавання слухача подій для кнопки \"Load more\"\nLOAD_MORE_BUTTON.addEventListener('click', loadMoreImages);\n"],"names":["KEY","PER_PAGE","fetchImages","search","page","url","response","axios","error","LOADER","GALLERY","lightbox","SimpleLightbox","showImages","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","imgLoad","loadDelay","img","resolve","reject","cautionIcon","errorIcon","SEARCH_FORM","SEARCH_INPUT","LOAD_MORE_BUTTON","currentPage","currentQuery","allImages","toggleLoadMoreButton","show","updateLoaderVisibility","loadMoreImages","data","totalHits","totalPages","iziToast","cardHeight","performSearch","query","searchFormSubmit","event"],"mappings":"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"}